<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="Authentication using an Asymmetric Key - Sender"><meta name="keywords" content="rust, rustlang, rust-lang, SetupAuthS"><title>SetupAuthS in hpke - Rust</title><link rel="preload" as="font" type="font/woff2" crossorigin href="../SourceSerif4-Regular.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../FiraSans-Regular.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../FiraSans-Medium.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../SourceCodePro-Regular.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../SourceSerif4-Bold.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../SourceCodePro-Semibold.ttf.woff2"><link rel="stylesheet" type="text/css" href="../normalize.css"><link rel="stylesheet" type="text/css" href="../rustdoc.css" id="mainThemeStyle"><link rel="stylesheet" type="text/css" href="../ayu.css" disabled><link rel="stylesheet" type="text/css" href="../dark.css" disabled><link rel="stylesheet" type="text/css" href="../light.css" id="themeStyle"><script id="default-settings" ></script><script src="../storage.js"></script><script defer src="sidebar-items.js"></script><script defer src="../main.js"></script><noscript><link rel="stylesheet" href="../noscript.css"></noscript><link rel="alternate icon" type="image/png" href="../favicon-16x16.png"><link rel="alternate icon" type="image/png" href="../favicon-32x32.png"><link rel="icon" type="image/svg+xml" href="../favicon.svg"></head><body class="rustdoc fn"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle">&#9776;</button><a class="sidebar-logo" href="../hpke/index.html"><div class="logo-container"><img class="rust-logo" src="../rust-logo.svg" alt="logo"></div>
        </a><h2 class="location"></h2>
    </nav>
    <nav class="sidebar"><a class="sidebar-logo" href="../hpke/index.html"><div class="logo-container"><img class="rust-logo" src="../rust-logo.svg" alt="logo"></div>
        </a><div class="sidebar-elems"><h2 class="location"><a href="index.html">In hpke</a></h2></div></nav><main><div class="width-limiter"><div class="sub-container"><a class="sub-logo-container" href="../hpke/index.html"><img class="rust-logo" src="../rust-logo.svg" alt="logo"></a><nav class="sub"><form class="search-form"><div class="search-container"><span></span><input class="search-input" name="search" autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"><div id="help-button" title="help" tabindex="-1"><button type="button">?</button></div><div id="settings-menu" tabindex="-1">
                                <a href="../settings.html" title="settings"><img width="22" height="22" alt="Change settings" src="../wheel.svg"></a></div>
                        </div></form></nav></div><section id="main-content" class="content"><div class="main-heading">
    <h1 class="fqn"><span class="in-band">Function <a href="index.html">hpke</a>::<wbr><a class="fn" href="#">SetupAuthS</a><button id="copy-path" onclick="copy_path(this)" title="Copy item path to clipboard"><img src="../clipboard.svg" width="19" height="18" alt="Copy item path"></button></span></h1><span class="out-of-band"><a class="srclink" href="../src/hpke/hpke.rs.html#522-538">source</a> · <a id="toggle-all-docs" href="javascript:void(0)" title="collapse all docs">[<span class="inner">&#x2212;</span>]</a></span></div><div class="docblock item-decl"><pre class="rust fn"><code>pub fn SetupAuthS(<br>&nbsp;&nbsp;&nbsp;&nbsp;config: <a class="struct" href="struct.HPKEConfig.html" title="struct hpke::HPKEConfig">HPKEConfig</a>, <br>&nbsp;&nbsp;&nbsp;&nbsp;pkR: &amp;<a class="type" href="type.HpkePublicKey.html" title="type hpke::HpkePublicKey">HpkePublicKey</a>, <br>&nbsp;&nbsp;&nbsp;&nbsp;info: &amp;<a class="type" href="../hpke_kdf/type.Info.html" title="type hpke_kdf::Info">Info</a>, <br>&nbsp;&nbsp;&nbsp;&nbsp;skS: &amp;<a class="type" href="../hpke_kem/type.PrivateKey.html" title="type hpke_kem::PrivateKey">PrivateKey</a>, <br>&nbsp;&nbsp;&nbsp;&nbsp;randomness: <a class="type" href="../hpke_kem/type.Randomness.html" title="type hpke_kem::Randomness">Randomness</a><br>) -&gt; <a class="type" href="type.SenderContextResult.html" title="type hpke::SenderContextResult">SenderContextResult</a></code></pre></div><details class="rustdoc-toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><h3 id="authentication-using-an-asymmetric-key---sender"><a href="#authentication-using-an-asymmetric-key---sender">Authentication using an Asymmetric Key - Sender</a></h3>
<p>This variant extends the base mechanism by allowing the recipient
to authenticate that the sender possessed a given KEM private key.
This is because <a href="../hpke_kem/fn.AuthDecap.html"><code>AuthDecap(enc, skR, pkS)</code></a> produces the correct KEM
shared secret only if the encapsulated value <code>enc</code> was produced by
<a href="../hpke_kem/fn.AuthEncap.html"><code>AuthEncap(pkR, skS)</code></a>, where <code>skS</code> is the private key corresponding
to <code>pkS</code>.  In other words, at most two entities (precisely two, in the case
of DHKEM) could have produced this secret, so if the recipient is at most one, then
the sender is the other with overwhelming probability.</p>
<p>The primary difference from the base case is that the calls to
<code>Encap()</code> and <code>Decap()</code> are replaced with calls to <a href="../hpke_kem/fn.AuthEncap.html"><code>AuthEncap()</code></a> and
<a href="../hpke_kem/fn.AuthDecap.html"><code>AuthDecap()</code></a>, which add the sender public key to their internal
context string. The function parameters <code>pkR</code> and <code>pkS</code> are
public keys, and <code>enc</code> is an encapsulated KEM shared secret.</p>
<p>Obviously, this variant can only be used with a KEM that provides
<a href="../hpke_kem/fn.AuthEncap.html"><code>AuthEncap()</code></a> and <a href="../hpke_kem/fn.AuthDecap.html"><code>AuthDecap()</code></a> procedures.</p>
<p>This mechanism authenticates only the key pair of the sender, not
any other identifier.  If an application wishes to bind HPKE
ciphertexts or exported secrets to another identity for the sender
(e.g., an email address or domain name), then this identifier should be
included in the <code>info</code> parameter to avoid identity mis-binding issues <a href="https://doi.org/10.1007/bf00124891">IMB</a>.</p>
<div class="example-wrap"><pre class="language-text"><code>def SetupAuthS(pkR, info, skS):
  shared_secret, enc = AuthEncap(pkR, skS)
  return enc, KeyScheduleS(mode_auth, shared_secret, info,
                           default_psk, default_psk_id)</code></pre></div></div></details></section></div></main><div id="rustdoc-vars" data-root-path="../" data-current-crate="hpke" data-themes="ayu,dark,light" data-resource-suffix="" data-rustdoc-version="1.64.0-nightly (495b21669 2022-07-03)" ></div>
</body></html>